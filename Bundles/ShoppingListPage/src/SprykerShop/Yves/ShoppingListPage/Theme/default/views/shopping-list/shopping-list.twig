{% extends template('page-layout-shopping-list', 'ShoppingListPage') %}

{% block breadcrumbs %}
    {% include molecule('breadcrumb') with {
        data: {
            steps: [{
                label: 'customer.account' | trans,
            },{
                label: 'customer.account.shopping_list' | trans,
            }]
        }
    } only %}
{% endblock %}

{% define data = {
    title: _view.shoppingListOverview.shoppingList.name,
    shoppingList: _view.shoppingListOverview.shoppingList,
    shoppingListCollection: _view.shoppingListOverview.shoppingLists,
    shoppingListItems: _view.shoppingListItems
} %}

{% block customerNavigation %}
    {{ widgetGlobal('CustomerNavigationWidgetPlugin', 'shoppingList', data.shoppingList.idShoppingList) }}
{% endblock %}

{% block customerContent %}
    <div class="box">
        <div class="grid grid--justify">
            <div class="col">
                <h4>{{ data.shoppingList.name }}</h4>
            </div>
            <div class="col">
                {% if can('WriteShoppingListPermissionPlugin', data.shoppingList.idShoppingList) %}
                    <a class="button button--success" href="{{ url('shopping-list/update', { idShoppingList: data.shoppingList.idShoppingList }) }}">{{ data.labels.editLabel }}</a>
                    <a class="button button--success" href="{{ url('shopping-list/share', { idShoppingList: data.shoppingList.idShoppingList }) }}">{{ data.labels.shareLabel }}</a>
                {% endif %}
                <a class="button button--success" href="{{ path('shopping-list/print', {idShoppingList: data.shoppingList.idShoppingList}) }}" target="_blank">{{data.labels.printShoppingList}}</a>
            </div>
        </div>
        <hr>

        {% include molecule('shopping-list-info', 'ShoppingListPage') with {
            data: {
                shoppingList: data.shoppingList
            }
        } only %}

        <hr/>
        {% if data.shoppingListItems|length %}
            <form method="POST" action="{{ path('shopping-list/add-to-cart') }}">
                <div class="grid grid--justify spacing-y spacing-y--inner">
                    <div class="col">
                        <button type="submit" class="button button--success" {{qa('submit-button')}}>
                            {{ data.labels.addSelectedItemsToCartLabel }}
                        </button>
                    </div>
                    <div class="col">
                        <button type="submit" class="button button--success" name="add-all-available" value="1" {{qa('submit-button')}}>
                            {{ data.labels.addAllToCartLabel }}
                        </button>
                    </div>
                </div>

                <input type="hidden" value="{{ data.shoppingList.idShoppingList }}" name="idShoppingList"/>

                <div class="is-scrollable-x">
                    {% include molecule('shopping-list-table', 'ShoppingListPage') with {
                        class: 'table table--expand',
                        data: {
                            shoppingList: data.shoppingList,
                            shoppingListItems: data.shoppingListItems
                        }
                    } only %}
                </div>
            </form>
        {% else %}
            {{ data.labels.shoppingListEmptyLabel }}
        {% endif %}
    </div>
{% endblock %}
