{% extends model('component') %}

{% define config = {
    name: 'shopping-list-overview-table',
} %}

{% define data = {
    shoppingLists: required,
    idShoppingList: null,
    shoppingListForm: null,
    shoppingListResponse: null,
    labels: required
} %}

{% block body %}
    <table class="table table--expand">
        <thead>
            <tr>
                <th></th>
                <th class="text-left">{{ data.labels.nameLabel }}</th>
                <th>{{ data.labels.ownerLabel }}</th>
                <th>{{ data.labels.createdDateLabel }}</th>
                <th>{{ data.labels.accessLabel }}</th>
                <th>{{ data.labels.itemCountLabel }}</th>
                <th>{{ data.labels.actionsLabel }}</th>
            </tr>
        </thead>
        <tbody>
        {% for shoppingList in data.shoppingLists %}

            {% set hasWritePermission = can('WriteShoppingListPermissionPlugin', shoppingList.idShoppingList) %}

            <tr>
                <td>
                    {% if data.enableTableForm %}
                        <input title="{{ data.labels.addShoppingListToCartLabel }}" type="checkbox" name="shoppingLists[]" value="{{ shoppingList.idShoppingList }}" />
                    {% endif %}
                </td>
                <td>
                    <a class="text-center" href="{{ path('shopping-list/details', { idShoppingList: shoppingList.idShoppingList }) }}">{{ shoppingList.name }}</a>
                </td>
                <td class="text-center">{{ shoppingList.owner }}</td>
                <td class="text-center">{{ shoppingList.createdAt | formatDate }}</td>
                {% if hasWritePermission %}
                    <td class="text-center">
                        <label>{{ data.labels.fullAccessLabel }}</label>
                    </td>
                {% else %}
                    <td class="text-center">
                        <label>{{ data.labels.readOnlyLabel }}</label>
                    </td>
                {% endif %}
                <td class="text-center">{{ shoppingList.numberOfItems }}</td>
                <td>
                    {% include molecule('shopping-list-action-navigation', 'ShoppingListPage') with {
                        data: {
                            hasWritePermission: hasWritePermission,
                            idShoppingList: shoppingList.idShoppingList
                        }
                    } only %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}
