{% extends model('component') %}

{% define config = {
    name: 'quote-request-item-summary',
    tag: 'ul'
} %}

{% define data = {
    priceMode: required,
    unitPrice: required,
    subtotalPrice: required,
    cartItem: required
} %}

{% set priceModeGross = 'GROSS_MODE' %}
{% set sourceUnitPrice = (data.priceMode == priceModeGross) ? data.cartItem.sourceUnitGrossPrice : data.cartItem.sourceUnitNetPrice %}

{% if sourceUnitPrice %}
    {% set sourceSumPrice = sourceUnitPrice * data.cartItem.quantity %}
{% endif %}


{% block class %}{{ parent() }} list{% endblock %}

{% block body %}
    <li class="list__item spacing-y">
        {% if can('SeePricePermissionPlugin') %}
            {{ 'cart.item.item_price' | trans }}
            {% if sourceUnitPrice %}
                <span class="float-right"><s>{{ data.unitPrice }}</s> {{ sourceUnitPrice | money }}</span>
            {% else %}
                <span class="float-right">{{ data.unitPrice }}</span>
            {% endif %}
        {% endif %}
    </li>

    {% if data.cartItem.productOptions | length > 0 %}
        <li class="list__item text-small">
            {% if widgetExists('CartItemProductOptionWidgetPlugin') %}
                {{ widget('CartItemProductOptionWidgetPlugin', data.cartItem) }} {# @deprecated Use molecule('product-options', 'ProductOptionWidget') instead. #}
            {% else %}
                {% include molecule('product-options', 'ProductOptionWidget') ignore missing with {
                    data: {
                        options: data.cartItem.productOptions | default([])
                    }
                } only %}
            {% endif %}
        </li>
    {% endif %}


    <li class="list__item spacing-y">
        {% if can('SeePricePermissionPlugin') %}
            <strong>{{ 'cart.item.item_total' | trans }}</strong>
            {% if sourceUnitPrice %}
                <strong class="float-right"><s>{{ data.subtotalPrice }}</s> {{ sourceSumPrice | money }}</strong>
            {% else %}
                <strong class="float-right">{{ data.subtotalPrice }}</strong>
            {% endif %}
        {% else %}
            {{ 'customer.access.cannot_see_price' | trans }}
        {% endif %}
    </li>

{% endblock %}
