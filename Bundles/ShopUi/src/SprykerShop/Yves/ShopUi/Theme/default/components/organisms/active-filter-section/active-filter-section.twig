{% extends model('component') %}

{% set config = {
    name: 'active-filter-section',
    tag: 'section'
} | merge(config | default({})) %}

{% set data = {
    facets: data.facets | default([]),
} | merge(data | default({})) %}

{% set activeFilters = [] %}

{% for filter in data.facets %}
    {% set activeFilter = include(
        [
            molecule('active-filter-' ~ filter.config.name),
            molecule('active-filter-' ~ filter.config.type)
        ], 
        {
            class: config.name ~ '__item',
            data: {
                filter: filter
            }
        }, 
        with_context = false, 
        ignore_missing = true
    ) %}

    {% if activeFilter | trim is not empty %}
        {% set activeFilters = activeFilters | merge([activeFilter]) %}
    {% endif %}    
{% endfor %}

{%- block class -%}
    {{parent()}} box
{%- endblock -%}

{% block component %}
    {% if activeFilters | length > 0 %}
        {{parent()}}
    {% endif %}
{% endblock %}

{% block body %}
    <small>{{ 'catalog.filter.activeFilters' | trans }}:</small>
    {{ activeFilters | join | raw }}

    <hr class="box__separator" />

    <div class="text-right">
        <a class="link link--small" href="{{ generateUrlWithoutAllActiveSearchFilters(data.facets) }}">
            {{ 'catalog.filter.resetAllFilters' | trans }} &times;
        </a>   
    </div>  
{% endblock %}
