{% extends model('component') %}

{% define config = {
    name: 'quantity-input',
    tag: 'label'
} %}

{% define data = {
    label: 'cart.item_quantity' | trans,
    maxQuantity: null,
    minQuantity: 1,
    value: 1,
    readOnly: false,
    hasUpdateButton: true
} %}

{% block body %}
    {% block label %}
        {{ data.label }}
    {% endblock %}

    <span class="grid">
        <span class="col col--expand">
            {% block input %}
                {% set maxQuantity = data.maxQuantity < 0 or data.maxQuantity < data.minQuantity ? null : data.maxQuantity %}

                <input
                    class="input input--expand"
                    type="number"
                    value="{{data.value}}"
                    name="quantity"
                    min="{{data.minQuantity}}"
                    {{qa('quantity-input')}}
                    {% if maxQuantity is not empty %}max="{{maxQuantity}}"{% endif %}
                    {% if data.readOnly %}disabled{% endif %} />
            {% endblock %}
        </span>

        {% if data.hasUpdateButton and not data.readOnly %}
            <span class="col">
                <button type="submit" class="button button--expand" {{qa('quantity-input-submit')}}>
                    {% include atom('icon') with {
                        modifiers: ['small'],
                        class: config.name ~ '__sync',
                        data: {
                            name: 'sync'
                        }
                    } only %}
                </button>
            </span>
        {% endif %}
    </span>
{% endblock %}
